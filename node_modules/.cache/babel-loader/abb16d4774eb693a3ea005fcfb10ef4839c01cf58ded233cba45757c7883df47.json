{"ast":null,"code":"import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport { apiService } from '../../services/apiService';\nconst initialState = {\n  words: [],\n  isTranscribing: false,\n  error: null,\n  selectedWords: []\n};\n\n// Async thunks\nexport const transcribeAudio = createAsyncThunk('transcript/transcribeAudio', async (projectId, {\n  rejectWithValue\n}) => {\n  try {\n    const response = await apiService.post(`/transcribe-audio`, {\n      projectId\n    });\n    return response.data;\n  } catch (error) {\n    var _error$response, _error$response$data;\n    return rejectWithValue(((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.error) || 'Transcription failed');\n  }\n});\nexport const removeFillers = createAsyncThunk('transcript/removeFillers', async ({\n  projectId,\n  selectedWords\n}, {\n  rejectWithValue\n}) => {\n  try {\n    const response = await apiService.post(`/remove-fillers`, {\n      projectId,\n      selectedWords\n    });\n    return response.data;\n  } catch (error) {\n    var _error$response2, _error$response2$data;\n    return rejectWithValue(((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : (_error$response2$data = _error$response2.data) === null || _error$response2$data === void 0 ? void 0 : _error$response2$data.error) || 'Filler removal failed');\n  }\n});\nexport const removeAutoDetectedFillers = createAsyncThunk('transcript/removeAutoDetectedFillers', async (projectId, {\n  rejectWithValue\n}) => {\n  try {\n    const response = await apiService.post(`/remove-fillers`, {\n      projectId,\n      autoDetect: true\n    });\n    return response.data;\n  } catch (error) {\n    var _error$response3, _error$response3$data;\n    return rejectWithValue(((_error$response3 = error.response) === null || _error$response3 === void 0 ? void 0 : (_error$response3$data = _error$response3.data) === null || _error$response3$data === void 0 ? void 0 : _error$response3$data.error) || 'Auto filler removal failed');\n  }\n});\nconst transcriptSlice = createSlice({\n  name: 'transcript',\n  initialState,\n  reducers: {\n    setWords: (state, action) => {\n      state.words = action.payload;\n    },\n    toggleWordSelection: (state, action) => {\n      const wordId = action.payload;\n      const index = state.selectedWords.indexOf(wordId);\n      if (index > -1) {\n        state.selectedWords.splice(index, 1);\n      } else {\n        state.selectedWords.push(wordId);\n      }\n    },\n    selectWords: (state, action) => {\n      state.selectedWords = action.payload;\n    },\n    clearSelection: state => {\n      state.selectedWords = [];\n    },\n    markAsFiller: (state, action) => {\n      const word = state.words.find(w => w.text === action.payload);\n      if (word) {\n        word.isFiller = true;\n      }\n    },\n    clearError: state => {\n      state.error = null;\n    },\n    resetTranscript: state => {\n      state.words = [];\n      state.selectedWords = [];\n      state.error = null;\n    }\n  },\n  extraReducers: builder => {\n    // Transcribe audio\n    builder.addCase(transcribeAudio.pending, state => {\n      state.isTranscribing = true;\n      state.error = null;\n    }).addCase(transcribeAudio.fulfilled, (state, action) => {\n      var _action$payload;\n      state.isTranscribing = false;\n      if ((_action$payload = action.payload) !== null && _action$payload !== void 0 && _action$payload.data) {\n        state.words = action.payload.data.transcript || [];\n      }\n    }).addCase(transcribeAudio.rejected, (state, action) => {\n      state.isTranscribing = false;\n      state.error = action.payload || 'Transcription failed';\n    });\n\n    // Remove fillers\n    builder.addCase(removeFillers.pending, state => {\n      state.isTranscribing = true;\n      state.error = null;\n    }).addCase(removeFillers.fulfilled, state => {\n      state.isTranscribing = false;\n      state.selectedWords = [];\n    }).addCase(removeFillers.rejected, (state, action) => {\n      state.isTranscribing = false;\n      state.error = action.payload || 'Filler removal failed';\n    });\n\n    // Remove auto detected fillers\n    builder.addCase(removeAutoDetectedFillers.pending, state => {\n      state.isTranscribing = true;\n      state.error = null;\n    }).addCase(removeAutoDetectedFillers.fulfilled, state => {\n      state.isTranscribing = false;\n    }).addCase(removeAutoDetectedFillers.rejected, (state, action) => {\n      state.isTranscribing = false;\n      state.error = action.payload || 'Auto filler removal failed';\n    });\n  }\n});\nexport const {\n  setWords,\n  toggleWordSelection,\n  selectWords,\n  clearSelection,\n  markAsFiller,\n  clearError,\n  resetTranscript\n} = transcriptSlice.actions;\nexport default transcriptSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","apiService","initialState","words","isTranscribing","error","selectedWords","transcribeAudio","projectId","rejectWithValue","response","post","data","_error$response","_error$response$data","removeFillers","_error$response2","_error$response2$data","removeAutoDetectedFillers","autoDetect","_error$response3","_error$response3$data","transcriptSlice","name","reducers","setWords","state","action","payload","toggleWordSelection","wordId","index","indexOf","splice","push","selectWords","clearSelection","markAsFiller","word","find","w","text","isFiller","clearError","resetTranscript","extraReducers","builder","addCase","pending","fulfilled","_action$payload","transcript","rejected","actions","reducer"],"sources":["/Users/miko/Documents/Project/real_projects/Snipix_web/src/redux/slices/transcriptSlice.ts"],"sourcesContent":["import { createSlice, createAsyncThunk, PayloadAction } from '@reduxjs/toolkit';\nimport { TranscriptState, TranscriptWord, TranscribeResponse, RemoveFillersResponse, ApiResponse } from '../../types';\nimport { apiService } from '../../services/apiService';\n\nconst initialState: TranscriptState = {\n  words: [],\n  isTranscribing: false,\n  error: null,\n  selectedWords: [],\n};\n\n// Async thunks\nexport const transcribeAudio = createAsyncThunk(\n  'transcript/transcribeAudio',\n  async (projectId: string, { rejectWithValue }) => {\n    try {\n      const response = await apiService.post<ApiResponse<TranscribeResponse>>(`/transcribe-audio`, {\n        projectId,\n      });\n      return response.data;\n    } catch (error: any) {\n      return rejectWithValue(error.response?.data?.error || 'Transcription failed');\n    }\n  }\n);\n\nexport const removeFillers = createAsyncThunk(\n  'transcript/removeFillers',\n  async ({ projectId, selectedWords }: { projectId: string; selectedWords: string[] }, { rejectWithValue }) => {\n    try {\n      const response = await apiService.post<ApiResponse<RemoveFillersResponse>>(`/remove-fillers`, {\n        projectId,\n        selectedWords,\n      });\n      return response.data;\n    } catch (error: any) {\n      return rejectWithValue(error.response?.data?.error || 'Filler removal failed');\n    }\n  }\n);\n\nexport const removeAutoDetectedFillers = createAsyncThunk(\n  'transcript/removeAutoDetectedFillers',\n  async (projectId: string, { rejectWithValue }) => {\n    try {\n      const response = await apiService.post<ApiResponse<RemoveFillersResponse>>(`/remove-fillers`, {\n        projectId,\n        autoDetect: true,\n      });\n      return response.data;\n    } catch (error: any) {\n      return rejectWithValue(error.response?.data?.error || 'Auto filler removal failed');\n    }\n  }\n);\n\nconst transcriptSlice = createSlice({\n  name: 'transcript',\n  initialState,\n  reducers: {\n    setWords: (state, action: PayloadAction<TranscriptWord[]>) => {\n      state.words = action.payload;\n    },\n    toggleWordSelection: (state, action: PayloadAction<string>) => {\n      const wordId = action.payload;\n      const index = state.selectedWords.indexOf(wordId);\n      if (index > -1) {\n        state.selectedWords.splice(index, 1);\n      } else {\n        state.selectedWords.push(wordId);\n      }\n    },\n    selectWords: (state, action: PayloadAction<string[]>) => {\n      state.selectedWords = action.payload;\n    },\n    clearSelection: (state) => {\n      state.selectedWords = [];\n    },\n    markAsFiller: (state, action: PayloadAction<string>) => {\n      const word = state.words.find((w: TranscriptWord) => w.text === action.payload);\n      if (word) {\n        word.isFiller = true;\n      }\n    },\n    clearError: (state) => {\n      state.error = null;\n    },\n    resetTranscript: (state) => {\n      state.words = [];\n      state.selectedWords = [];\n      state.error = null;\n    },\n  },\n  extraReducers: (builder) => {\n    // Transcribe audio\n    builder\n      .addCase(transcribeAudio.pending, (state) => {\n        state.isTranscribing = true;\n        state.error = null;\n      })\n      .addCase(transcribeAudio.fulfilled, (state, action) => {\n        state.isTranscribing = false;\n        if (action.payload?.data) {\n          state.words = action.payload.data.transcript || [];\n        }\n      })\n      .addCase(transcribeAudio.rejected, (state, action) => {\n        state.isTranscribing = false;\n        state.error = action.payload as string || 'Transcription failed';\n      });\n\n    // Remove fillers\n    builder\n      .addCase(removeFillers.pending, (state) => {\n        state.isTranscribing = true;\n        state.error = null;\n      })\n      .addCase(removeFillers.fulfilled, (state) => {\n        state.isTranscribing = false;\n        state.selectedWords = [];\n      })\n      .addCase(removeFillers.rejected, (state, action) => {\n        state.isTranscribing = false;\n        state.error = action.payload as string || 'Filler removal failed';\n      });\n\n    // Remove auto detected fillers\n    builder\n      .addCase(removeAutoDetectedFillers.pending, (state) => {\n        state.isTranscribing = true;\n        state.error = null;\n      })\n      .addCase(removeAutoDetectedFillers.fulfilled, (state) => {\n        state.isTranscribing = false;\n      })\n      .addCase(removeAutoDetectedFillers.rejected, (state, action) => {\n        state.isTranscribing = false;\n        state.error = action.payload as string || 'Auto filler removal failed';\n      });\n  },\n});\n\nexport const {\n  setWords,\n  toggleWordSelection,\n  selectWords,\n  clearSelection,\n  markAsFiller,\n  clearError,\n  resetTranscript,\n} = transcriptSlice.actions;\n\nexport default transcriptSlice.reducer;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}